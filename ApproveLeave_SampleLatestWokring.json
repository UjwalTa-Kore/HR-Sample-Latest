{"_id":"dg-cae44535-5b9f-549e-9f5a-cdcb6ba31940","refId":"299ff1b9-2f7d-5b34-9286-5317e042ff55","nodes":[{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"intent0","type":"intent","transitions":[{"default":"entity24","metadata":{"color":"#299d8e","connId":"dummy0"}}],"metadata":{"left":56,"top":3},"componentIndex":6},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"service1","type":"service","transitions":[{"if":{"context":"context.getEmployeeData.response.body.length","op":"eq","value":"0"},"then":"message19","metadata":{"color":"#299d8e","connId":"dummy60"}},{"default":"script18","metadata":{"color":"#299d8e","connId":"dummy1"}}],"metadata":{"left":45,"top":310},"componentIndex":10},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"script2","type":"script","transitions":[{"if":{"context":"isWidget","op":"eq","value":"true"},"then":"end","metadata":{"color":"#f3a261","connId":"dummy85"}},{"if":{"context":"noEmployeeData","op":"eq","value":"true"},"then":"","metadata":{"color":"#299d8e","connId":"dummy6"}},{"if":{"context":"noReportees","op":"eq","value":"true"},"then":"","metadata":{"color":"#5ea8d3","connId":"dummy7"}},{"if":{"context":"awaitingApproval.length","op":"gt","value":"0"},"then":"entity5","metadata":{"color":"#e9c369","connId":"dummy24"}},{"default":"message12","metadata":{"color":"#299d8e","connId":"dummy3"}}],"metadata":{"left":1378,"top":78},"componentIndex":2},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"message4","type":"message","transitions":[{"default":"","metadata":{"color":"#299d8e","connId":"dummy7"}}],"metadata":{"left":1765,"top":0},"componentIndex":11},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task","type":{"option":"doNotAllowHoldResume"}},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"3","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"precedence":"entityOverIntent","message":[],"errorMessage":[]},"nodeId":"entity5","type":"entity","transitions":[{"default":"script10","metadata":{"color":"#299d8e","connId":"dummy9"}}],"metadata":{"left":1102,"top":408},"componentIndex":0},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"service9","type":"service","transitions":[{"if":{"context":"leavesToApprove.length","op":"gt","value":"0"},"then":"script16","metadata":{"color":"#299d8e","connId":"dummy45"}},{"default":"message14","metadata":{"color":"#299d8e","connId":"dummy17"}}],"metadata":{"left":600,"top":882},"componentIndex":5},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"script10","type":"script","transitions":[{"default":"script15","metadata":{"color":"#299d8e","connId":"dummy19"}}],"metadata":{"left":727,"top":541},"componentIndex":13},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"script11","type":"script","transitions":[{"default":"message14","metadata":{"color":"#299d8e","connId":"dummy21"}}],"metadata":{"left":60,"top":642},"componentIndex":14},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task","type":{"option":"doNotAllowHoldResume"}},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"message12","type":"message","transitions":[{"default":"end","metadata":{"color":"#299d8e","connId":"dummy23"}}],"metadata":{"left":853,"top":293},"componentIndex":18},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task","type":{"option":"doNotAllowHoldResume"}},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"message14","type":"message","transitions":[{"default":"end","metadata":{"color":"#299d8e","connId":"dummy27"}}],"metadata":{"left":290,"top":880},"componentIndex":1},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"script15","type":"script","transitions":[{"default":"script16","metadata":{"color":"#299d8e","connId":"dummy40"}}],"metadata":{"left":895,"top":661},"componentIndex":12},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"script16","type":"script","transitions":[{"default":"service9","metadata":{"color":"#299d8e","connId":"dummy42"}}],"metadata":{"left":885,"top":785},"componentIndex":15},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"service17","type":"service","transitions":[{"default":"script22","metadata":{"color":"#299d8e","connId":"dummy57"}}],"metadata":{"left":842,"top":15},"componentIndex":16},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"script18","type":"script","transitions":[{"if":{"context":"Wflag","op":"eq","value":"1"},"then":"end","metadata":{"color":"#5ea8d3","connId":"dummy154"}},{"if":{"context":"context.testEmp.length","op":"eq","value":"0"},"then":"message12","metadata":{"color":"#299d8e","connId":"dummy141"}},{"default":"script20","metadata":{"color":"#299d8e","connId":"dummy58"}}],"metadata":{"left":390,"top":300},"componentIndex":9},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"message19","type":"message","transitions":[{"default":"end","metadata":{"color":"#299d8e","connId":"dummy59"}}],"metadata":{"left":50,"top":500},"componentIndex":4},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"script20","type":"script","transitions":[{"default":"service17","metadata":{"color":"#299d8e","connId":"dummy84"}}],"metadata":{"left":385,"top":194},"componentIndex":3},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"message":[],"errorMessage":[]},"nodeId":"script22","type":"script","transitions":[{"if":{"context":"context.employees.length","op":"gt","value":"0"},"then":"script20","metadata":{"color":"#299d8e","connId":"dummy113"}},{"default":"script2","metadata":{"color":"#299d8e","connId":"dummy110"}}],"metadata":{"left":839,"top":141},"componentIndex":8},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"optional","reuseMarkedupPhrases":false,"interruptOptions":{"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"precedence":"entityOverIntent","message":[],"errorMessage":[]},"nodeId":"entity24","type":"entity","transitions":[{"default":"service1","metadata":{"color":"#299d8e","connId":"dummy152"}}],"metadata":{"left":41,"top":137},"componentIndex":17},{"nodeOptions":{"customTags":{"session":[],"message":[],"user":[]},"transitionType":"auto","promptOptions":"required","reuseMarkedupPhrases":false,"interruptOptions":{"interruptsEnabled":true,"priority":"task"},"transitionMode":"initiateCurrentTask","inputHandlingOptions":"useAsEntityValue","reuseOptions":"1","noAutoCorrection":false,"notForReuse":false,"contextTags":[],"precedence":"entityOverIntent","message":[],"errorMessage":[]},"nodeId":"entity25","type":"entity","transitions":[{"default":"","metadata":{"color":"#299d8e","connId":"dummy152"}}],"metadata":{"left":686,"top":903},"componentIndex":7}],"localeData":{"en":{"name":"ApproveLeave","shortDesc":""}},"defaultLanguage":"en","interruptOptions":{"priority":"bot"},"contextLifeTime":{"options":"close"},"amendConfig":{"priority":"bot"},"name":"ApproveLeave","sentences":[{"sentence":"review leave request","type":"DialogIntent","entities":[],"language":"en","taskName":"ApproveLeave","taskId":"b335a5b7-12af-52f9-882b-ba65e2c6ab10"},{"sentence":"View pending leave request","type":"DialogIntent","entities":[],"language":"en","taskName":"ApproveLeave","taskId":"b335a5b7-12af-52f9-882b-ba65e2c6ab10"},{"taskId":"b335a5b7-12af-52f9-882b-ba65e2c6ab10","sentence":"approve leave","taskName":"ApproveLeave","type":"DialogIntent","language":"en","entities":[]}],"components":[{"applyDefaultTemplate":true,"entityFields":{"cityAdvanced":[]},"entityType":"list_of_values","errorMessage":[{"localeData":{"en":{"text":"I'm sorry, I did not recognize the value you have entered. Please select a value from the list.","type":"basic"}},"channel":"default"}],"isArray":true,"localeData":{"en":{"label":"approvedLeave","allowedValues":{"variable":"context.leaves","titleKey":"title","valueKey":"value","synonymsKey":"value","indexKey":""}}},"message":[{"localeData":{"en":{"text":"var%20message%20%3D%20%7B%0D%0A%20%20%22type%22%3A%20%22template%22%2C%0D%0A%20%20%22payload%22%3A%20%7B%0D%0A%20%20%20%20%22template_type%22%3A%20%22multi_select%22%2C%0D%0A%20%20%20%20%22buttons%22%3A%20%5B%0D%0A%20%20%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20%22title%22%3A%20%22Approve%22%2C%0D%0A%20%20%20%20%20%20%20%20%22type%22%3A%20%22postback%22%2C%0D%0A%20%20%20%20%20%20%20%20%22payload%22%3A%20%22payload%22%0D%0A%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%5D%2C%0D%0A%20%20%20%20%22elements%22%3A%20context.leaves%0D%0A%20%20%7D%0D%0A%7D%3B%0D%0A%0D%0Aprint(JSON.stringify(message))%3B%20","type":"uxmap"}},"channel":"rtm"},{"localeData":{"en":{"text":"var%20message%20%3D%20%7B%0D%0A%20%20%22type%22%3A%20%22template%22%2C%0D%0A%20%20%22payload%22%3A%20%7B%0D%0A%20%20%20%20%22template_type%22%3A%20%22multi_select%22%2C%0D%0A%20%20%20%20%22buttons%22%3A%20%5B%0D%0A%20%20%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20%22title%22%3A%20%22Approve%22%2C%0D%0A%20%20%20%20%20%20%20%20%22type%22%3A%20%22postback%22%2C%0D%0A%20%20%20%20%20%20%20%20%22payload%22%3A%20%22payload%22%0D%0A%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%5D%2C%0D%0A%20%20%20%20%22elements%22%3A%20context.leaves%0D%0A%20%20%7D%0D%0A%7D%3B%0D%0A%0D%0Aprint(JSON.stringify(message))%3B%20","type":"uxmap"}},"channel":"default"},{"localeData":{"en":{"text":"var%20message%20%3D%20%7B%0D%0A%20%20%22type%22%3A%20%22template%22%2C%0D%0A%20%20%22payload%22%3A%20%7B%0D%0A%20%20%20%20%22template_type%22%3A%20%22multi_select%22%2C%0D%0A%20%20%20%20%22buttons%22%3A%20%5B%0D%0A%20%20%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20%22title%22%3A%20%22Approve%22%2C%0D%0A%20%20%20%20%20%20%20%20%22type%22%3A%20%22postback%22%2C%0D%0A%20%20%20%20%20%20%20%20%22payload%22%3A%20%22payload%22%0D%0A%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%5D%2C%0D%0A%20%20%20%20%22elements%22%3A%20context.leaves%0D%0A%20%20%7D%0D%0A%7D%3B%0D%0A%0D%0Aprint(JSON.stringify(message))%3B%20","type":"uxmap"}},"channel":"ivrInst-8a593ff3-4a34-5f7f-8ea9-ca5b05f3b0ec"}],"name":"approvedLeave","preConditions":[],"refId":"017aa84f-c027-5c82-a668-acf0f363580d","type":"entity"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"Approve Done"}},"message":[{"localeData":{"en":{"text":"Leave%20has%20been%20approved.","type":"basic"}},"channel":"default"}],"name":"M_approveDone","preConditions":[],"refId":"1ac85bf2-dc29-551f-a6cd-3b381dfe00d0","type":"message"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"getApprovalPendingLeaves"}},"name":"getApprovalPendingLeaves","preConditions":[],"refId":"b7a28152-61bc-5daf-958e-70235fae74b0","script":"function%20getEmpData(empId)%7B%0D%0A%20%20%20%20var%20data%3Dcontext.getEmployeeData.response.body%3B%0D%0A%20%20%20%20for(var%20i%3D0%3Bi%3Cdata.length%3Bi%2B%2B)%0D%0A%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20if(data%5Bi%5D.employeeId%3D%3DempId)%0D%0A%20%20%20%20%20%20%20%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20data%5Bi%5D%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%7D%0D%0A%20%20%20%20return%20%5B%5D%0D%0A%7D%0D%0A%0D%0Acontext.awaitingApproval%20%3D%20%5B%5D%3B%0D%0Avar%20leavess%20%3D%20context.LeavesData%3B%0D%0Avar%20leaveCount%20%3D%20leavess.length%3B%0D%0A%2F%2F%20%20for(let%20j%3D0%3B%20j%3CleaveCount%3B%20j%2B%2B)%7B%0D%0A%2F%2F%20%20%20%20%20%20%20%20%20let%20leave%20%3D%20leavess%5Bj%5D%3B%0D%0A%2F%2F%20%20%20%20%20%20%20%20%20if(leave.statusId%20%3D%3D%20%22applied%22)%20%7B%0D%0A%2F%2F%20%20%20%20%20%20%20%20%20%20%20%20%20leave.displayText%20%3D%20leave.employeeId%20%2B%20'%5C's%20'%20%2B%20leave.typeId%20%2B%20'%20leave%20from%20'%20%2B%20leave.dates%5B0%5D%20%2B%20'%20to%20'%20%2B%20leave.dates%5B1%5D%3B%0D%0A%2F%2F%20%20%20%20%20%20%20%20%20%20%20%20%20context.awaitingApproval.push(leave)%3B%0D%0A%2F%2F%20%20%20%20%20%20%20%20%20%7D%0D%0A%2F%2F%20%20%7D%0D%0A%20leavess.forEach(l%3D%3E%7B%0D%0A%20%20%20%20%20let%20Leave%20%3D%20l.leave%3B%0D%0A%20%20%20%20%20Leave.forEach(l1%3D%3E%7B%0D%0A%20%20%20%20%20%20%20%20let%20leave%20%3Dl1%3B%0D%0A%20%20%20%20%20%20%20%20if(leave.statusId%20%3D%3D%20%22applied%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20leave.displayText%20%3D%20leave.employeeId%20%2B%20'%5C's%20'%20%2B%20leave.typeId%20%2B%20'%20leave%20from%20'%20%2B%20leave.dates%5B0%5D%20%2B%20'%20to%20'%20%2B%20leave.dates%5B1%5D%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20context.awaitingApproval.push(leave)%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%7D)%0D%0A%20%20%20%20%20%0D%0A%20%7D)%0D%0A%20%0D%0A%20var%20lst%20%3D%20context.awaitingApproval%3B%0D%0A%0D%0Alet%20count%20%3D%20lst.length%3B%0D%0A%2F%2F%20lst.forEach(emp%3D%3E%7B%0D%0Avar%20leaves%3D%20%5B%5D%3B%0D%0Afor(let%20i%3D0%3B%20i%3Ccount%3B%20i%2B%2B)%20%7B%0D%0A%20%20%20%20%20%20%20%20var%20empData%20%3D%20getEmpData(lst%5Bi%5D.employeeId)%3B%2F%2Fcontext.getEmployeeData.response.body%5B0%5D%3B%0D%0A%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20let%20from%20%3D%20(new%20Date(lst%5Bi%5D.dates%5B0%5D)).getDate()%3B%0D%0A%20%20%20%20%20%20%20%20context.fromDate%20%3D%20from%3B%0D%0A%20%20%20%20%20%20%20%20let%20to%20%3D%20(new%20Date(lst%5Bi%5D.dates%5B1%5D)).getDate()%3B%0D%0A%20%20%20%20%20%20%20%20let%20diff%20%3D%20to%20-%20from%20%2B%201%3B%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20from%20%3D%20new%20Date(lst%5Bi%5D.dates%5B0%5D)%3B%0D%0A%20%20%20%20%20%20%20%20from%20%3D%20from.getMonth()%2B1%20%2B%20%22%2F%22%20%2B%20from.getDate()%20%2B%20%22%2F%22%20%2B%20from.getFullYear()%3B%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if(lst%5Bi%5D.typeId%20%3D%3D%20%22pto%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20lst%5Bi%5D.typeId%20%3D%20'PTO'%3B%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20if(lst%5Bi%5D.typeId%20%3D%3D%20%22civicDuty%22)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20lst%5Bi%5D.typeId%20%3D%22Civic%20Duty%22%3B%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20lst%5Bi%5D.typeId%20%3D%20lst%5Bi%5D.typeId.charAt(0).toUpperCase()%20%2B%20lst%5Bi%5D.typeId.slice(1)%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20if(diff%20%3D%3D%201)%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20days%20%3D%20'day'%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20id%20%3D%20empData.firstName%20%2B%20'%20'%20%2B%20empData.lastName%20%2B%20'%5C's%20'%20%2B%20lst%5Bi%5D.typeId%20%2B%20'%20leave%20on%20'%20%2B%20from%3B%0D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20days%20%3D%20'days'%3B%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20id%20%3D%20empData.firstName%20%2B%20'%20'%20%2B%20empData.lastName%20%2B%20'%5C's%20'%20%2B%20lst%5Bi%5D.typeId%20%2B%20'%20leave%20for%20'%20%2B%20diff%20%2B%20'%20'%20%2B%20days%20%2B%20'%20starting%20'%20%2B%20from%3B%0D%0A%20%20%20%20%20%20%20%20%7D%0D%0A%20%20%20%20%20%20%20%20%0D%0A%20%20%20%20%20%20%20%20leaves.push(%7Btitle%3A%20id%20%2Cvalue%3Alst%5Bi%5D.id%20%7D)%3B%0D%0A%20%20%20%20%7D%0D%0A%0D%0Acontext.leaves%20%3D%20leaves%3B%0D%0A%0D%0ABotUserSession.put(%22leavesToApprove%22%2C%20leaves%2C5)%3B%0D%0A%0D%0A","type":"script"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"Script0004"}},"name":"preparePayloadtoApprove","preConditions":[],"refId":"f741e2b0-8668-5726-aaa1-8182003e1dde","script":"if(context.employees.length%3E0)%0A%7B%0A%20%20%20%20var%20employeeId%20%3D%20context.employees.pop()%0A%20%20%20%20%0A%20%20%20%20context.eid%3DemployeeId%0A%20%20%20%20context.payload%20%3D%20JSON.stringify(%7B%0A%20%20%20%20%20%20%20%20%22employeeId%22%20%3A%20employeeId%20%20%0A%20%20%20%20%20%20%20%20%7D)%0A%7D","type":"script"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"noEmployeeData"}},"message":[{"localeData":{"en":{"text":"Sorry%2C%20we%20don't%20have%20your%20data%20on%20our%20records.%20Make%20sure%20you%20have%20completed%20your%20onboarding%20process.","type":"basic"}},"channel":"default"}],"name":"noEmployeeData","preConditions":[],"refId":"30760db4-a322-5363-9c1d-68ec837af5b6","type":"message"},{"endPoint":{"port":"","path":"{{env.URL_updateLeave}}","method":"put","connectorEnabled":false,"piiDataEnabled":false},"entityFields":{"cityAdvanced":[]},"headers":{"type":"raw","value":"{\"Content-Type\":\"application/json\"}"},"idp":"none","localeData":{"en":{"label":"updateLeaveStatus"}},"name":"updateLeaveStatus","payload":{"type":"raw","value":"%7B%0A%20%20%22id%22%3A%20%22%7B%7Bcontext.leaveIdToApprove%7D%7D%22%2C%0A%20%20%22statusId%22%3A%22approved%22%0A%7D"},"preConditions":[],"refId":"180264b2-ca92-5d24-904f-6ac868bd048a","sampleResponse":[{"name":"sampleResponse","isDefault":true,"response":"\"{\\n  \\\"id\\\": \\\"699533a2fe0ea85d\\\"\\n  \\\"status\\\":\\\"approved\\\",\\n  \\\"approvedOn\\\": \\\"2019-09-11\\\"\\n}\""}],"serviceAPITimeout":20,"serviceNodeType":"custom","serviceType":"rest","type":"service"},{"dialogId":"dg-cae44535-5b9f-549e-9f5a-cdcb6ba31940","entityFields":{"cityAdvanced":[]},"localeData":{"en":{"desc":"","intent":"ApproveLeave","negativePatterns":[{"value":"discard all","original":"discard all"}]}},"name":"ApproveLeave","preConditions":[],"refId":"b335a5b7-12af-52f9-882b-ba65e2c6ab10","type":"intent","dialogRefId":"299ff1b9-2f7d-5b34-9286-5317e042ff55"},{"entityFields":{"cityAdvanced":[]},"entityType":"label","errorMessage":[{"localeData":{"en":{"text":"I'm sorry, I am unable to recognize the string. Please enter again.","type":"basic"}},"channel":"default"}],"localeData":{"en":{"label":"Entity0003"}},"message":[{"localeData":{"en":{"text":"Sample prompt message for Entity0003","type":"basic"}},"channel":"default"}],"name":"Entity0003","preConditions":[],"refId":"4ed6bc59-6d54-5279-841e-4a56f72289b6","type":"entity"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"UpdateLeavesIntoContext"}},"name":"UpdateLeavesIntoContext","preConditions":[],"refId":"5956fd2f-6700-56ee-b45b-1ef1c390371e","script":"var%20data%3Dcontext.getAllLeaves.response.body%0A%2F%2F%20var%20empId%3DJSON.parse(context.payload).employeeId%0A%2F%2F%20var%20f%3Dcontext.eid%0A%0Acontext.LeavesData.push(%0A%20%20%20%20%7B%0A%20%20%20%20%20%22employeeId%22%3Acontext.eid%2C%0A%20%20%20%20%20%22leave%22%3Adata%0A%20%20%20%20%7D)%0A","type":"script"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"Script0004"}},"name":"getUserProfile","preConditions":[],"refId":"a4f94561-8582-5b9d-ace8-655c8b22e511","script":"%2F%2F%20var%20email%20%3D%20userProfile(context.session)%3B%0A%2F%2F%20context.userProfile%3D%7B%22email%22%3A%22ujwal.tadur%40kore.com%22%7D%0Avar%20email%3D''%0Aif(context.entities.Email)%0A%20%20%20%20email%20%3D%20context.entities.Email%3B%0Aelse%20if(context.session.BotUserSession.lastMessage.messagePayload.from)%0A%20%20%20%20email%3Dcontext.session.BotUserSession.lastMessage.messagePayload.from%0Aelse%20if(context.session.UserContext.emailId)%0A%20%20%20%20email%3Dcontext.session.UserContext.emailId%0A%2F%2F%20else%0A%2F%2F%20%7B%0A%20%20%20%20%0A%2F%2F%20%7D%0A%2F%2F%20if(context.session.BotUserSession.channels%5B0%5D.reqId)%0Aif(email)%0A%7B%0A%20%20%20%20%2F%2F%20email%3Dcontext.session.BotUserSession.lastMessage.messagePayload.from%2F%2F%22ujwal.tadur%40kore.com%22%3B%2F%2Fcontext.session.BotUserSession.channels%5B0%5D.reqId.split(%22%2B%22)%5B1%5D%0A%20%20%20%20BotUserSession.put(%22userProfile%22%2Cemail)%3B%0A%7D%0Aelse%0A%7B%0A%20%20%20%20%2F%2F%20context.userProfile%3D%7B%22email%22%3A%22ujwal.tadur%40kore.com%22%7D%3B%0A%20%20%20%20BotUserSession.put(%22userProfile%22%2C%22ab%40koraqa1.com%22)%3B%0A%7D%0A%2F%2Femail%3Dcontext.userProfile.email%0A%2F%2F%20koreDebugger.log(%22email%20is%20%3A%22%2Bemail)%3B%0Avar%20data%3Dcontext.getEmployeeData.response.body%3B%0Acontext.managerId%3D%22%22%0Afor(i%3D0%3Bi%3Cdata.length%3Bi%2B%2B)%0A%7B%0A%20%20%20%20if(data%5Bi%5D.email%3D%3Demail)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20context.managerId%3Ddata%5Bi%5D.employeeId%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%7D%0Acontext.employees%3D%5B%5D%0Aif(context.managerId!%3D%3D%22%22)%0A%7B%0Adata.forEach(i%3D%3E%7B%0A%20%20%20%20if(i.managerId%3D%3Dcontext.managerId)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20context.employees.push(i.employeeId)%0A%20%20%20%20%7D%0A%7D)%0A%7D%0Acontext.testEmp%3Dcontext.employees%3B%0Acontext.LeavesData%3D%5B%5D%0Acontext.Wflag%3D0%0Aif(context.testEmp.length%3D%3D%3D0%20%26%26context.isWidget)%0A%7B%0A%20%20%20%20context.Wflag%3D1%0A%7D%0ABotUserSession.put(%22Wflag%22%2Ccontext.Wflag)%3B","type":"script"},{"endPoint":{"port":"","path":"{{env.URL_getEmployeeData}}","method":"post","connectorEnabled":false,"piiDataEnabled":false},"entityFields":{"cityAdvanced":[]},"headers":{"type":"raw","value":"{\"Content-Type\":\"application/json\"}"},"idp":"none","localeData":{"en":{"label":"get Employee Data"}},"name":"getEmployeeData","payload":{"type":"raw","value":""},"preConditions":[],"refId":"19dad129-f0ab-559a-bdc7-32685d2f9bae","sampleResponse":[{"name":"sampleResponse","isDefault":true,"response":"{\"statusCode\":200,\"body\":[{\"dOB\":\"10-10-1980\",\"email\":\"john.doe@kore.com\",\"employeeId\":\"KI002\",\"employeeType\":\"fullTime\",\"firstName\":\"John\",\"gender\":\"male\",\"joiningDate\":\"10-01-2013\",\"lastName\":\"Doe\",\"managerId\":\"KI101\",\"middleName\":\"\",\"phone\":\"8787876767\",\"id\":\"aba02349e9b848e1\"}],\"headers\":{\"server\":\"nginx/1.16.1\",\"date\":\"Fri, 13 Dec 2019 14:38:48 GMT\",\"content-type\":\"application/json; charset=utf-8\",\"content-length\":\"257\",\"connection\":\"close\",\"x-powered-by\":\"Express\",\"access-control-allow-origin\":\"*\",\"access-control-allow-methods\":\"PUT, GET, POST, DELETE, OPTIONS\",\"access-control-allow-headers\":\"Content-Type\",\"etag\":\"W/\\\"101-Rhd98nJhlXbN06fkH2yV5Ky3FAw\\\"\"}}"}],"serviceAPITimeout":20,"serviceNodeType":"custom","serviceType":"rest","type":"service"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"noReportees"}},"message":[{"localeData":{"en":{"text":"Sample message for Message0005","type":"basic"}},"channel":"default"}],"name":"noReportees","preConditions":[],"refId":"6b843009-fb7f-5735-8138-0ddd4c255f8f","type":"message"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"Script0002"}},"name":"Script0002","preConditions":[],"refId":"4feb4842-55fb-5df5-b35c-11bdbe1d63af","script":"context.leavesToApprove%20%3D%20context.entities.approvedLeave%3B","type":"script"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"getCurrentDate"}},"name":"getCurrentDate","preConditions":[],"refId":"d005de8a-3688-5842-b337-c93d00cba678","script":"context.currentDate%20%3D%20new%20Date().toJSON().slice(0%2C10)","type":"script"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"updatePendingList"}},"name":"updatePendingList","preConditions":[],"refId":"1fd3b3f2-c2b6-5da1-bee8-89fef1bec66a","script":"var%20leaves%20%3D%20context.awaitingApproval%3B%0A%0Alet%20count%20%3D%20leaves.length%3B%0Afor(let%20i%3D0%3B%20i%3Ccount%3B%20i%2B%2B)%20%7B%0A%20%20%20%20let%20leave%20%3D%20leaves%5Bi%5D%3B%0A%20%20%20%20if(leave.id%20%3D%3D%20context.entities.approvedLeave)%20%7B%0A%20%20%20%20%20%20%20%20var%20removed%20%3D%20leaves.splice(i%2C1)%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%7D%0A%0Aif(leaves.length%20%3E%200)%20%7B%0A%20%20%20%20context.awaitingApproval%20%3D%20leaves%3B%0A%20%20%20%20%2F%2F%20Set%20the%20entity%20to%20null%20so%20that%20we%20can%20show%20the%20updated%20pending%20list%0A%20%20%20%20delete%20context.entities.approvedLeave%3B%0A%20%20%20%20context.approvalListUpdated%20%3D%20true%3B%0A%7D%20else%20%7B%0A%20%20%20%20context.awaitingApproval%20%3D%20null%3B%0A%7D","type":"script"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"Script0003"}},"name":"Script0003","preConditions":[],"refId":"fec9a51c-6fbe-5cf0-bae3-c45b320bd616","script":"context.leaveIdToApprove%20%3D%20context.leavesToApprove.pop()%3B%0A","type":"script"},{"endPoint":{"port":"","path":"{{env.URL_getLeave}}","method":"post","connectorEnabled":false,"piiDataEnabled":false},"entityFields":{"cityAdvanced":[]},"headers":{"type":"raw","value":"{\"Content-Type\":\"application/json\"}"},"idp":"none","localeData":{"en":{"label":"get All Leaves"}},"name":"getAllLeaves","payload":{"type":"raw","value":"%7B%7Bcontext.payload%7D%7D"},"preConditions":[],"refId":"5ca82d27-d70a-580e-98bd-c04c930e840d","serviceAPITimeout":20,"serviceNodeType":"custom","serviceType":"rest","type":"service"},{"entityFields":{"cityAdvanced":[]},"entityType":"email","errorMessage":[{"localeData":{"en":{"text":"I'm sorry, I did not recognize the email you entered. Please enter the email again. An example of an email address is JohnDoe@abc.com.","type":"basic"}},"channel":"default"}],"localeData":{"en":{"label":"Email"}},"message":[{"localeData":{"en":{"text":"Enter%20emailId","type":"basic"}},"channel":"default"}],"name":"Email","preConditions":[],"refId":"9dd30fb4-de07-51b9-bd53-009b67b2989a","type":"entity"},{"entityFields":{"cityAdvanced":[]},"localeData":{"en":{"label":"noPendingApprovals"}},"message":[{"localeData":{"en":{"text":"You%20have%20no%20leaves%20pending%20for%20approval.","type":"basic"}},"channel":"default"}],"name":"noPendingApprovals","preConditions":[],"refId":"06998791-87ab-5faf-9f6d-f0ba9c5d49ff","type":"message"}]}